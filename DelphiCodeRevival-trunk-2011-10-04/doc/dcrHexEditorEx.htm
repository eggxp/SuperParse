<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>
<META name="GENERATOR" content="DIPasDoc 0.8.10">
<TITLE>dcrHexEditorEx</TITLE>
<LINK rel="StyleSheet" href="Help.css">
</HEAD>
<BODY bgcolor="#ffffff" text="#000000" link="#0000ff" vlink="#800080" alink="#FF0000">
<TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor="e0e0e0">
<TD><A href="AllUnits.htm"><CENTER>Units</CENTER></A></TD>
<TD><A href="ClassHierarchy.htm"><CENTER>Class Hierarchy</CENTER></A></TD>
<TD><A href="AllClass.htm"><CENTER>Classes, Interfaces and Objects</CENTER></A></TD>
<TD><A href="AllTypes.htm"><CENTER>Types</CENTER></A></TD>
<TD><A href="AllEnums.htm"><CENTER>Enumerations</CENTER></A></TD>
<TD><A href="AllVaria.htm"><CENTER>Variables</CENTER></A></TD>
<TD><A href="AllConst.htm"><CENTER>Constants</CENTER></A></TD>
<TD><A href="AllFuncs.htm"><CENTER>Functions and Procedures</CENTER></A></TD>
<TD><A href="AllIdent.htm"><CENTER>Identifiers</CENTER></A></TD>
</TR>
</TABLE>
<H1>Unit dcrHexEditorEx</H1>
<H2>Description</H2>
TMPHexEditorEx, an enhanced TMPHexEditor: print and preview, ole drag and drop, ole clipboard handling, file backups...<P>TMPHexEditorEx v 07-10-2010<br> credits to :<br><br> - John Hamm, http://users.snapjax.com/john/<br><br> - Christophe Le Corfec for introducing the EBCDIC format and the nice idea about half byte insert/delete<br><br> - Philippe Chessa for his suggestions about AsText, AsHex and better support for the french keyboard layout<br><br> - Daniel Jensen for octal offset display and the INS-key recognition stuff<br><br> - Shmuel Zeigerman for introducing more flexible offset display formats<br><br> - Vaf, http://carradio.al.ru for reporting missing delver.inc and suggesting OnChange<br><br> - Eugene Tarasov for reporting that setting the BytesPerColumn value to 4 at design time didn't work<br><br> - FuseBurner for BytesPerUnit/RulerBytesPerUnit related suggestions<br><br> - Motzi for SyncView/ShowPositionIfNotFocused related suggestions<br><br> - Martin Hsiao for bcb compatibility and reporting some bugs when moving cursor beyond eof<br><br> - Miyu for delphi 7 defines<br><br> - Nils Hoyer for bcb testing, his help on creating a BCB6 package and standard actions support<br><br> - Skamnitsly S.V for reporting a bug when doubleclicking the ruler bar<br><br> - Pete Fraser for reporting problems with array properties under BCB<br><br> - Andrew Novikov for bug reports and suggestions<br><br> - Al for bug reports<br><br> - Dieter K&ouml;hler for reporting the delphi vcl related CanFocus bug<br><br> - Piotr Likus for reporting a cardinal&lt;-&gt;integer related bug in the Undo method<br><br> - Marc Girod for bug reports<br><br> - Gerd Schwartz for reporting a bug with printing headers/footers that contain long texts<br><br> - Bogdan Ureche for reporting an integer overflow when moving the cursor over a large selection<br><br> - Heybirder for reporting that delphi 6 has not TStringList.ValueFromIndex property<br><br> - Magnus Flysj&ouml; for his Delphi2006 package and the updated MPDELVER.INC file<br><br> - Patrick Kolla for OwnerData, Delphi XE, and maintaining the LaunchPad project<br><br> <h3>history:</h3> <p><ul> <li>v 07-10-20010 october 7, 2010<br><br> - the project source is now on LaunchPad as part of the Delphi Code Revival series<br> - first public release with OwnerData - source code is Delphi XE (and ths hopefully 2009) compatible<br><br></li> <li>v 09-30-2007: september 30, 2007<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>)<br> - added support for exporting regedit hexdata clipboard format<br> - added support for unicode characters wider than latin characters (they are now painted/printed using a smaller font)<br><br><li> <li>v 12-06-2006: december 06, 2006<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>)<br> - standard actions support<br><br></li> <li>v 05-24-2006: may 24, 2006<br><br> - fixed painting bug when drawing solid "secondary" cursor frames (FocusFrame = False)<br> - restored compatibility of mphexeditorex.pas with delphi 6<br><br></li> <li>v 02-06-2006: february 06, 2006<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 05-23-2005: may 23, 2005<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 12-29-2004: december 29, 2004<br><br> - initialized Result to '' in some string functions/methods to avoid non empty Result vars at function startup due to compiler optimizations (particularly on d4), e.g. printing did not work correctly under d4<br> - updated some of the sample projects (fixed the broken bcb6 sample, added printing to the hex viewer and the bcb6 editor sample) <br><br></li> <li>v 12-28-2004: december 28, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 12-21-2004: december 21, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>)<br> - support for CF_HTML clipboard format<br><br></li> <li>v 11-12-2004: november 12, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>)<br> - ole drag and drop move operation is now disabled if the editor's ReadOnlyView property is set to True<br><br></li> <li>v 10-26-2004: october 26, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>)/unit (<CODE>mphexeditor</CODE>) only <br><br></li> <li>v 08-29-2004: august 29, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>)<br> - added pfIncludeRuler to <CODE><A href="dcrHexEditorEx.htm#TMPHPrintFlag">TMPHPrintFlag</A></CODE><br><br></li> <li>v 08-14-2004: august 14, 2004<br><br> - changed printing (color handling, pfSelectionBold meaning)<br><br></li> <li>v 06-15-2004: june 15, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) and some more inherited published properties <br><br></li> <li>v 06-10-2004: june 10, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 06-07-2004: june 07, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 05-27-2004: may 27, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 05-13-2004: may 13, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 04-18-2004: april 18, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 01-08-2004: january 08, 2004<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 12-16-2003: december 16, 2003<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 12-10-2003: december 10, 2003<br><br> - changes in the base class (<CODE><A href="TCustomMPHexEditor.htm">TCustomMPHexEditor</A></CODE>) only <br><br></li> <li>v 09-24-2003: september 24, 2003 <br><br> - modified the BCB6 package <br><br></li> <li>v 09-09-2003: september 09, 2003<br><br> - changed <CODE><A href="TCustomMPHexEditor.htm#UndoBeginUpdate">UndoBeginUpdate</A></CODE> and <CODE><A href="TCustomMPHexEditor.htm#UndoEndUpdate">UndoEndUpdate</A></CODE> behaviour to automatically create an undo record on UndoBeginUpdate and check it on UndoEndUpdate, see also <CODE><A href="TMPHexEditorEx.htm#CreateUndoOnUndoUpdate">CreateUndoOnUndoUpdate</A></CODE><br> - added property <CODE><A href="TMPHexEditorEx.htm#CreateUndoOnUndoUpdate">CreateUndoOnUndoUpdate</A></CODE> <br> - added defines for delphi7, renamed delver.inc to mpdelver.inc <br> - <CODE><A href="TMPHexEditorEx.htm#PasteData">PasteData</A></CODE> method added <br><br></li> <li>v 07-05-2003: july 05, 2003<br><br> - added support for pasting clipboard data in fixed filesize mode<br> - added RegEdit_HexData clipboard support<br><br></li> <li>v 05-25-2003-b: may 25, 2003<br><br> - fixed a bug (moving the cursor beyond eof)<br><br></li> <li>v 05-25-2003: may 25, 2003<br><br> - no ':' is printed when offset display is not used<br> - added hpp generating statements for bcb compatibility<br><br></li> <li>v 05-20-2003: may 20, 2003<br><br> - added unicode support in printing<br><br></li> <li>v 05-17-2003: may 17, 2003<br><br> - moved some property related functions to protected<br> - corrected bottom margin handling when printing<br> - corrected upper/lowercase hex chars in printing<br> - the current unit is selected now when doubleclicking data<br> - added flags pfCurrentViewOnly (just print the currently visible data) to <CODE><A href="TMPHexEditorEx.htm#PrintOptions">PrintOptions</A></CODE>.Flags<br><br></li> <li>v 08-18-2002: august 18, 2002<br><br> - first release</li> </ul></p><H2>Classes, Interfaces and Objects</H2>
<TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor="#e0e0e0"><TH>Name</TH><TH>Description</TH></TR>
<TR bgcolor=#efefef valign=top><TD>Class&nbsp;<A href="TMPHexEditorEx.htm"><CODE>TMPHexEditorEx</CODE></A></TD><TD width=100%>&nbsp;</TD></TR><TR bgcolor=#efefef valign=top><TD>Class&nbsp;<A href="TMPHPrintOptions.htm"><CODE>TMPHPrintOptions</CODE></A></TD><TD>&nbsp;</TD></TR></TABLE><H2>Functions and Procedures</H2>
<H3>Overview</H3>
<TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD width=100%><CODE>procedure <A href="#MPHSetHexClipboardData"><B>MPHSetHexClipboardData</B></A>(Data: Pointer; DataSize: integer; ScrapFileName: ShortString; TextAsHex, SwapNibbles: boolean);</CODE></TD></TR></TABLE><H3>Description</H3>
<TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD width=100%><A name="MPHSetHexClipboardData"><CODE>procedure <B>MPHSetHexClipboardData</B>(Data: Pointer; DataSize: integer; ScrapFileName: ShortString; TextAsHex, SwapNibbles: boolean);</CODE></A></TD></TR></TABLE><P>&nbsp;</P><H2>Types</H2>
<H3>Overview</H3>
<TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD width=100%><CODE><A href="#TMPHQueryPublicPropertyEvent"><B>TMPHQueryPublicPropertyEvent</B></A> = procedure(Sender: TObject; const PropertyName: string; var IsPublic: boolean) of object;</CODE></TD></TR></TABLE><H3>Description</H3>
<TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD width=100%><A name="TMPHQueryPublicPropertyEvent"><CODE><B>TMPHQueryPublicPropertyEvent</B> = procedure(Sender: TObject; const PropertyName: string; var IsPublic: boolean) of object;</CODE></A></TD></TR></TABLE><P>this event is called when <CODE>PropertiesAsString</CODE> is read or written. TMPHexEditorEx has a fixed list of properties that can be read/written using PropertiesAsString. you can exclude some of the properties by setting IsPublic to False.</P><H2>Enumerations</H2>
<TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor="#efefef" ><TD colspan="3"><A name="TMPHOLEOperation"><CODE><B>TMPHOLEOperation</B></CODE></A></TD></TR><TR><TD colspan="3">is data dropped or pasted</TD></TR><TR valign=top><TD>&nbsp;</TD><TD><A name="oleDrop"><CODE>oleDrop</CODE></A></TD><TD>&nbsp;</TD></TR><TR valign=top><TD>&nbsp;</TD><TD><A name="oleClipboard"><CODE>oleClipboard</CODE></A></TD><TD>&nbsp;</TD></TR></TABLE><TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor="#efefef" ><TD colspan="3"><A name="TMPHPrintFlag"><CODE><B>TMPHPrintFlag</B></CODE></A></TD></TR><TR><TD colspan="3">print option flags:<br><br> - pfSelectionOnly: only print data currently selected<br> - pfSelectionBold: render the current selection using either a bold font or inverted colors (if pfSelectionOnly isn't set)<br> - pfMonochrome: don't use colors, print/preview black on white<br> - pfUseBackgroundColor: fill the margin rect with the editor's background color (if pfMonochrome isn't set)<br> - pfCurrentViewOnly: just print the data currently displayed<br> - pfIncludeRuler: draw the ruler at every page's top<br></TD></TR><TR valign=top><TD>&nbsp;</TD><TD><A name="pfSelectionOnly"><CODE>pfSelectionOnly</CODE></A></TD><TD>&nbsp;</TD></TR><TR valign=top><TD>&nbsp;</TD><TD><A name="pfSelectionBold"><CODE>pfSelectionBold</CODE></A></TD><TD>&nbsp;</TD></TR><TR valign=top><TD>&nbsp;</TD><TD><A name="pfMonochrome"><CODE>pfMonochrome</CODE></A></TD><TD>&nbsp;</TD></TR><TR valign=top><TD>&nbsp;</TD><TD><A name="pfUseBackgroundColor"><CODE>pfUseBackgroundColor</CODE></A></TD><TD>&nbsp;</TD></TR><TR valign=top><TD>&nbsp;</TD><TD><A name="pfCurrentViewOnly"><CODE>pfCurrentViewOnly</CODE></A></TD><TD>&nbsp;</TD></TR><TR valign=top><TD>&nbsp;</TD><TD><A name="pfIncludeRuler"><CODE>pfIncludeRuler</CODE></A></TD><TD>&nbsp;</TD></TR></TABLE><H2>Constants</H2>
<H3>Overview</H3>
<TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD width=100%><CODE><A href="#MPH_DEF_PRINT_MARGINS"><B>MPH_DEF_PRINT_MARGINS</B></A> : TRect  = (Left: 20; Top: 15; Right: 25; Bottom: 25);</CODE></TD></TR></TABLE><H3>Description</H3>
<TABLE cellspacing=1 cellpadding=4 width=100%>
<TR bgcolor=#efefef valign=top><TD width=100%><A name="MPH_DEF_PRINT_MARGINS"><CODE><B>MPH_DEF_PRINT_MARGINS</B> : TRect  = (Left: 20; Top: 15; Right: 25; Bottom: 25);</CODE></A></TD></TR></TABLE><P>default print margins</P><H2>Author</H2>
<P>(C) markus stephany, <a href="http://launchpad.net/dcr">Delphi Code Revival</a>, all rights reserved.</P><H2>Last Modified</H2>
<P>07-10-2010
</P><HR noshade size=1><EM>Generated by <A href="http://www.yunqa.de/delphi/">DIPasDoc 0.8.10</A> on Do 07. Okt 2010 13:15:08</EM>
</BODY>
</HTML>
